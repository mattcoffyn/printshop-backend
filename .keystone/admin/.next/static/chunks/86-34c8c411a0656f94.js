(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[86],{1086:function(e,t,i){"use strict";i.d(t,{p:function(){return L}});var l=i(7896),n=i(4273),a=i.n(n),o=i(9097),r=i(5632),s=i(2784),d=i(5631),c=i(5445),u=i(6759),g=i(3123),m=i(5273),p=i(4141),h=i(3900),v=i(5364),f=i(8626),Z=i(4944),y=i(7078),x=i(7286),b=(i(3080),i(522)),w=i(2225),k=i(81),C=i(1964),F=i(5703),$=i(9446),S=i(2480),D=(i(9378),i(9740));i(2881),i(6172),i(7668),i(7532),i(2180),i(1168),i(5976),i(581),i(1596),i(423),i(891),i(1511),i(5893);const I=["children"],R=e=>{let{children:t}=e,i=(0,D.Z)(e,I);return(0,c.tZ)("div",(0,l.Z)({css:{minWidth:0,maxWidth:1080}},i),t)};function z(e){const t=(0,s.useRef)(e),i=(0,s.useCallback)((function(){return t.current(...arguments)}),[]);return(0,s.useEffect)((()=>{t.current=e})),i}function E(e){var t,i,l;let{listKey:n,itemGetter:a,selectedFields:o,fieldModes:r,showDelete:d}=e;const u=(0,F.sm)(n),[g,{loading:m,error:p,data:h}]=(0,w.D)(k.Ps`mutation ($data: ${u.gqlNames.updateInputName}!, $id: ID!) {
      item: ${u.gqlNames.updateMutationName}(where: { id: $id }, data: $data) {
        ${o}
      }
    }`,{errorPolicy:"all"});a=null!==(t=(0,s.useMemo)((()=>{if(h)return(0,y.m)(h,null===p||void 0===p?void 0:p.graphQLErrors).get("item")}),[h,p]))&&void 0!==t?t:a;const[f,Z]=(0,s.useState)((()=>({value:(0,b.d)(u.fields,a),item:a})));if(!m&&f.item.data!==a.data&&(a.errors||[]).every((e=>{var t;return 1!==(null===(t=e.path)||void 0===t?void 0:t.length)}))){const e=(0,b.d)(u.fields,a);Z({value:e,item:a})}const{changedFields:C,dataForUpdate:$}=(0,b.u)(u.fields,f.item,f.value),D=(0,b.a)(u.fields,f.value),[I,R]=(0,s.useState)(!1),E=(0,v.e)(),L=z((()=>{const e=0!==D.size;R(e),e||g({variables:{data:$,id:f.item.get("id").data}}).then((e=>{let{errors:t}=e;const i=null===t||void 0===t?void 0:t.find((e=>{var t;return 1===(null===(t=e.path)||void 0===t?void 0:t.length)}));i?E.addToast({title:"Failed to update item",tone:"negative",message:i.message}):E.addToast({tone:"positive",title:"Saved successfully"})})).catch((e=>{E.addToast({title:"Failed to update item",tone:"negative",message:e.message})}))})),T=null===(i=f.item.data)||void 0===i?void 0:i[u.labelField],j=null===(l=f.item.data)||void 0===l?void 0:l.id;return(0,c.tZ)(c.xu,{marginTop:"xlarge"},(0,c.tZ)(S.G,{networkError:null===p||void 0===p?void 0:p.networkError,errors:null===p||void 0===p?void 0:p.graphQLErrors.filter((e=>{var t;return 1===(null===(t=e.path)||void 0===t?void 0:t.length)}))}),(0,c.tZ)(x.F,{fieldModes:r,fields:u.fields,forceValidation:I,invalidFields:D,onChange:(0,s.useCallback)((e=>{Z((t=>({item:t.item,value:e(t.value)})))}),[Z]),value:f.value}),(0,c.tZ)(N,{onSave:L,hasChangedFields:!!C.size,onReset:z((()=>{Z((e=>({item:e.item,value:(0,b.d)(u.fields,e.item)})))})),loading:m,deleteButton:(0,s.useMemo)((()=>d?(0,c.tZ)(M,{list:u,itemLabel:null!==T&&void 0!==T?T:j,itemId:j}):void 0),[d,u,T,j])}))}function M(e){let{itemLabel:t,itemId:i,list:l}=e;const n=(0,v.e)(),[a,{loading:o}]=(0,w.D)(k.Ps`mutation ($id: ID!) {
      ${l.gqlNames.deleteMutationName}(where: { id: $id }) {
        id
      }
    }`,{variables:{id:i}}),[u,g]=(0,s.useState)(!1),m=(0,r.useRouter)();return(0,c.tZ)(s.Fragment,null,(0,c.tZ)(d.zx,{tone:"negative",onClick:()=>{g(!0)}},"Delete"),(0,c.tZ)(p.aR,{title:"Delete Confirmation",isOpen:u,tone:"negative",actions:{confirm:{label:"Delete",action:async()=>{try{await a()}catch(e){return n.addToast({title:`Failed to delete ${l.singular} item: ${t}`,message:e.message,tone:"negative"})}return m.push(`/${l.path}`),n.addToast({title:t,message:`Deleted ${l.singular} item successfully`,tone:"positive"})},loading:o},cancel:{label:"Cancel",action:()=>{g(!1)}}}},"Are you sure you want to delete ",(0,c.tZ)("strong",null,t),"?"))}const L=e=>()=>(0,c.tZ)(T,e),T=e=>{var t,i,n,p;let{listKey:v}=e;const x=(0,r.useRouter)(),{id:b}=x.query,w=(0,F.sm)(v),{palette:D,spacing:I,typography:z}=(0,c.Fg)(),{query:M,selectedFields:L}=(0,s.useMemo)((()=>{let e=Object.entries(w.fields).filter((e=>{let[t,i]=e;return"hidden"!==i.itemView.fieldMode||"id"===t})).map((e=>{let[t]=e;return w.fields[t].controller.graphqlSelection})).join("\n");return{selectedFields:e,query:k.Ps`
        query ItemPage($id: ID!, $listKey: String!) {
          item: ${w.gqlNames.itemQueryName}(where: {id: $id}) {
            ${e}
          }
          keystone {
            adminMeta {
              list(key: $listKey) {
                hideCreate
                hideDelete
                fields {
                  path
                  itemView(id: $id) {
                    fieldMode
                  }
                }
              }
            }
          }
        }
      `}}),[w]);let{data:T,error:N,loading:K}=(0,C.a)(M,{variables:{id:b,listKey:v},errorPolicy:"all",skip:void 0===b});K||(K=void 0===b);const H=(0,y.m)(T,null===N||void 0===N?void 0:N.graphQLErrors);let P=(0,s.useMemo)((()=>{var e,t,i,l,n;let a={};return null===(e=H.data)||void 0===e||null===(t=e.keystone)||void 0===t||null===(i=t.adminMeta)||void 0===i||null===(l=i.list)||void 0===l||null===(n=l.fields)||void 0===n||n.forEach((e=>{var t;null!==e&&null!==e.path&&null!=(null===e||void 0===e||null===(t=e.itemView)||void 0===t?void 0:t.fieldMode)&&(a[e.path]=e.itemView.fieldMode)})),a}),[null===(t=H.data)||void 0===t||null===(i=t.keystone)||void 0===i||null===(n=i.adminMeta)||void 0===n||null===(p=n.list)||void 0===p?void 0:p.fields]);const W=H.get("keystone").errors,B=K?void 0:T&&T.item&&(T.item[w.labelField]||T.item.id)||b;return(0,c.tZ)($.P,{title:B,header:(0,c.tZ)(R,{css:{alignItems:"center",display:"flex",flex:1,justifyContent:"space-between"}},(0,c.tZ)("div",{css:{alignItems:"center",display:"flex",flex:1,minWidth:0}},(0,c.tZ)(c.X6,{type:"h3"},(0,c.tZ)(o.default,{href:`/${w.path}`,passHref:!0},(0,c.tZ)("a",{css:{textDecoration:"none"}},w.label))),(0,c.tZ)("div",{css:{color:D.neutral500,marginLeft:I.xsmall,marginRight:I.xsmall}},(0,c.tZ)(m.X,null)),(0,c.tZ)(c.X6,{as:"h1",type:"h3",css:{minWidth:0,maxWidth:"100%",overflow:"hidden",flex:1,textOverflow:"ellipsis",whiteSpace:"nowrap"}},K?"Loading...":T&&T.item&&(T.item[w.labelField]||T.item.id)||b)),!1)},K?(0,c.tZ)(c.M5,{css:{height:`calc(100vh - ${$.H}px)`}},(0,c.tZ)(u.xg,{label:"Loading item data",size:"large",tone:"passive"})):W?(0,c.tZ)(c.xu,{marginY:"xlarge"},(0,c.tZ)(h.qX,{tone:"negative"},W[0].message)):(0,c.tZ)(j,null,null==(null===T||void 0===T?void 0:T.item)?(0,c.tZ)(c.xu,{marginY:"xlarge"},null!==N&&void 0!==N&&N.graphQLErrors.length||null!==N&&void 0!==N&&N.networkError?(0,c.tZ)(S.G,{errors:null===N||void 0===N?void 0:N.graphQLErrors,networkError:null===N||void 0===N?void 0:N.networkError}):(0,c.tZ)(h.qX,{tone:"negative"},'The item with id "',b,"\" could not be found or you don't have access to it.")):(0,c.tZ)(s.Fragment,null,(0,c.tZ)(E,{fieldModes:P,selectedFields:L,showDelete:!T.keystone.adminMeta.list.hideDelete,listKey:v,itemGetter:H.get("item")}),(0,c.tZ)(q,null,(0,c.tZ)(Z.Qy,null,"Item ID"),(0,c.tZ)("div",{css:{display:"flex",alignItems:"center"}},(0,c.tZ)(Z.oi,{css:{marginRight:I.medium,fontFamily:z.fontFamily.monospace,fontSize:z.fontSize.small},readOnly:!0,value:T.item.id}),(0,c.tZ)(f.u,{content:"Copy ID"},(e=>(0,c.tZ)(d.zx,(0,l.Z)({},e,{"aria-label":"Copy ID",onClick:()=>{a()(T.item.id)}}),(0,c.tZ)(g.K,{size:"small"})))))))))},N=(0,s.memo)((function(e){let{hasChangedFields:t,loading:i,onSave:l,onReset:n,deleteButton:a}=e;const{colors:o,spacing:r}=(0,c.Fg)();return(0,c.tZ)("div",{css:{background:o.background,borderTop:`1px solid ${o.border}`,bottom:0,display:"flex",justifyContent:"space-between",marginTop:r.xlarge,paddingBottom:r.xlarge,paddingTop:r.xlarge,position:"sticky",zIndex:10}},(0,c.tZ)(c.Kq,{align:"center",across:!0,gap:"small"},(0,c.tZ)(d.zx,{isDisabled:!t,isLoading:i,weight:"bold",tone:"active",onClick:l},"Save changes"),t?(0,c.tZ)(d.zx,{weight:"none",onClick:n},"Reset changes"):(0,c.tZ)(c.xv,{weight:"medium",paddingX:"large",color:"neutral600"},"No changes")),a)})),j=e=>{const{spacing:t}=(0,c.Fg)();return(0,c.tZ)(R,{css:{position:"relative",height:"100%"}},(0,c.tZ)("div",(0,l.Z)({css:{alignItems:"start",display:"grid",gap:t.xlarge,gridTemplateColumns:"2fr 1fr"}},e)))},q=e=>{const{spacing:t}=(0,c.Fg)();return(0,c.tZ)("div",(0,l.Z)({css:{marginTop:t.xlarge,marginBottom:t.xxlarge,position:"sticky",top:t.xlarge}},e))}},9446:function(e,t,i){"use strict";i.d(t,{H:function(){return F},P:function(){return I}});var l=i(7896),n=i(5445),a=i(2784),o=i(9740),r=i(5632),s=i(5631),d=i(423),c=i(891),u=i(5273),g=i(5703),m=i(1511),p=i(5893),h=i(9097);const v=()=>{var e;const{spacing:t}=(0,n.Fg)(),{adminConfig:i}=(0,g.jf)();return null!==(e=i.components)&&void 0!==e&&e.Logo?(0,n.tZ)(i.components.Logo,null):(0,n.tZ)(n.H3,null,(0,n.tZ)(h.default,{href:"/",passHref:!0},(0,n.tZ)("a",{css:{backgroundImage:"linear-gradient(to right, #0ea5e9, #6366f1)",backgroundClip:"text",lineHeight:"1.75rem",color:"transparent",verticalAlign:"middle",transition:"color 0.3s ease",textDecoration:"none"}},(0,n.tZ)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 220 220",css:{display:"inline-block",width:"2rem",height:"2rem",margin:`0  ${t.medium}px ${t.xsmall}px 0`,verticalAlign:"middle"}},(0,n.tZ)("defs",null,(0,n.tZ)("linearGradient",{id:"logo-a",x1:"0%",x2:"50%",y1:"0%",y2:"71.9%"},(0,n.tZ)("stop",{offset:"0%",stopColor:"#5AE8FA"}),(0,n.tZ)("stop",{offset:"100%",stopColor:"#2684FF"}))),(0,n.tZ)("path",{fill:"url(#logo-a)",fillRule:"evenodd",d:"M290.1 47h117.5c17.8 0 24.3 1.9 30.8 5.3a36.3 36.3 0 0115.1 15.2c3.5 6.5 5.4 13 5.4 30.8v117.4c0 17.9-1.9 24.3-5.4 30.8a36.3 36.3 0 01-15.1 15.2c-6.5 3.4-13 5.3-30.8 5.3H290c-17.8 0-24.3-1.9-30.8-5.3a36.3 36.3 0 01-15.1-15.2c-3.5-6.5-5.3-13-5.3-30.8V98.3c0-17.9 1.8-24.3 5.3-30.8a36.3 36.3 0 0115.1-15.2c6.5-3.4 13-5.3 30.8-5.3zm11.8 56.8V218H327v-36.8l14.4-14.6 34.4 51.4h31.5l-49-69.1 44.7-45.1h-31.3L327 151v-47.3H302z",transform:"translate(-238.9 -47)"})),"Keystone 6")))},f=["children"],Z=e=>{let{href:t,children:i,isSelected:l}=e;const{colors:a,palette:o,spacing:s,radii:d,typography:c}=(0,n.Fg)(),u=(0,r.useRouter)(),g=void 0!==l?l:u.pathname===t;return(0,n.tZ)("li",null,(0,n.tZ)(m.rU,{"aria-current":!!g&&"location",href:t,css:{background:"transparent",borderBottomRightRadius:d.xsmall,borderTopRightRadius:d.xsmall,color:o.neutral700,display:"block",fontWeight:c.fontWeight.medium,marginBottom:s.xsmall,marginRight:s.xlarge,padding:`${s.small}px ${s.xlarge}px`,position:"relative",textDecoration:"none",":hover":{background:a.backgroundHover,color:a.linkHoverColor},"&[aria-current=location]":{background:o.neutral200,color:o.neutral900}}},i))},y=e=>{let{item:t}=e;const{apiPath:i}=(0,g.jf)(),{spacing:a,typography:o}=(0,n.Fg)();return(0,n.tZ)("div",{css:{alignItems:"center",display:"flex",flexDirection:"row",justifyContent:"space-between",margin:a.xlarge,marginBottom:0}},t&&"authenticated"===t.state?(0,n.tZ)("div",{css:{fontSize:o.fontSize.small}},"Signed in as ",(0,n.tZ)("strong",null,t.label)):(0,n.tZ)("div",{css:{fontSize:o.fontSize.small}},"GraphQL Playground and Docs"),(0,n.tZ)(d.J2,{placement:"bottom",triggerRenderer:e=>{let{triggerProps:t}=e;return(0,n.tZ)(s.zx,(0,l.Z)({size:"small",style:{padding:0,width:36},"aria-label":"Links and signout"},t),(0,n.tZ)(c.x,null))}},(0,n.tZ)(n.Kq,{gap:"medium",padding:"large",dividers:"between"},(0,n.tZ)(x,{target:"_blank",href:i},"API Explorer"),(0,n.tZ)(x,{target:"_blank",href:"https://github.com/keystonejs/keystone"},"GitHub Repository"),(0,n.tZ)(x,{target:"_blank",href:"https://keystonejs.com"},"Keystone Documentation"),t&&"authenticated"===t.state&&(0,n.tZ)(p.S,null))))},x=e=>{let{children:t}=e,i=(0,o.Z)(e,f);const{typography:a}=(0,n.Fg)();return(0,n.tZ)("a",(0,l.Z)({css:{alignItems:"center",display:"flex",fontSize:a.fontSize.small,textDecoration:"none"}},i),t,(0,n.tZ)(u.X,{size:"small"}))},b=e=>{let{authenticatedItem:t,children:i}=e;const{spacing:l}=(0,n.Fg)();return(0,n.tZ)("div",{css:{display:"flex",flexDirection:"column",justifyContent:"center",position:"relative"}},(0,n.tZ)(y,{item:t}),(0,n.tZ)("nav",{role:"navigation","aria-label":"Side Navigation",css:{marginTop:l.xlarge}},(0,n.tZ)("ul",{css:{padding:0,margin:0,li:{listStyle:"none"}}},i)))},w=e=>{let{list:t}=e;const i=(0,r.useRouter)();return(0,n.tZ)(Z,{isSelected:i.pathname.split("/")[1]===`/${t.path}`.split("/")[1],href:`/${t.path}`},t.label)},k=e=>{let{lists:t=[],include:i=[]}=e;const l=i.length>0?t.filter((e=>i.includes(e.key))):t;return(0,n.tZ)(a.Fragment,null,l.map((e=>(0,n.tZ)(w,{key:e.key,list:e}))))},C=()=>{var e;const{adminMeta:{lists:t},adminConfig:i,authenticatedItem:l,visibleLists:a}=(0,g.jf)();if("loading"===a.state)return null;if("error"===a.state)return(0,n.tZ)(n.xv,{as:"span",paddingLeft:"xlarge",css:{color:"red"}},a.error instanceof Error?a.error.message:a.error[0].message);const o=Object.keys(t).map((e=>a.lists.has(e)?t[e]:null)).filter((e=>Boolean(e)));return null!==i&&void 0!==i&&null!==(e=i.components)&&void 0!==e&&e.Navigation?(0,n.tZ)(i.components.Navigation,{authenticatedItem:l,lists:o}):(0,n.tZ)(b,{authenticatedItem:l},(0,n.tZ)(Z,{href:"/"},"Dashboard"),(0,n.tZ)(k,{lists:o}))},F=80,$=e=>(0,n.tZ)(a.Fragment,null,(0,n.tZ)("style",null,"body { overflow: hidden; }"),(0,n.tZ)("div",(0,l.Z)({css:{display:"grid",gridTemplateColumns:"minmax(300px, 1fr) 4fr",gridTemplateRows:`${F}px auto`,height:"100vh"}},e))),S=e=>(0,n.tZ)("aside",(0,l.Z)({css:{minWidth:0,overflowY:"auto",WebkitOverflowScrolling:"touch"}},e)),D=e=>{const{colors:t,spacing:i}=(0,n.Fg)();return(0,n.tZ)("main",(0,l.Z)({css:{backgroundColor:t.background,boxSizing:"border-box",minWidth:0,paddingLeft:i.xlarge,paddingRight:i.xlarge,overflowY:"auto",WebkitOverflowScrolling:"touch",position:"relative"}},e))},I=e=>{let{children:t,header:i,title:l}=e;const{colors:a,spacing:o}=(0,n.Fg)();return(0,n.tZ)($,null,(0,n.tZ)("div",{css:{alignItems:"center",borderBottom:`1px solid ${a.border}`,display:"flex",justifyContent:"space-between",paddingLeft:o.xlarge,paddingRight:o.xlarge}},(0,n.tZ)(v,null)),(0,n.tZ)("header",{css:{alignItems:"center",backgroundColor:a.background,borderBottom:`1px solid ${a.border}`,display:"flex",justifyContent:"space-between",minWidth:0,paddingLeft:o.xlarge,paddingRight:o.xlarge}},(0,n.tZ)("title",null,l?`Keystone - ${l}`:"Keystone"),i),(0,n.tZ)(S,null,(0,n.tZ)(C,null)),(0,n.tZ)(D,null,t))}},3123:function(e,t,i){"use strict";i.d(t,{K:function(){return a}});var l=i(2784),n=i(7074);i(5445);const a=(0,n.c)(l.createElement(l.Fragment,null,l.createElement("path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"}),l.createElement("rect",{x:8,y:2,width:8,height:4,rx:1,ry:1})),"ClipboardIcon")},4273:function(e){function t(){return new DOMException("The request is not allowed","NotAllowedError")}e.exports=async function(e){try{await async function(e){if(!navigator.clipboard)throw t();return navigator.clipboard.writeText(e)}(e)}catch(i){try{await async function(e){const i=document.createElement("span");i.textContent=e,i.style.whiteSpace="pre",i.style.webkitUserSelect="auto",i.style.userSelect="all",document.body.appendChild(i);const l=window.getSelection(),n=window.document.createRange();l.removeAllRanges(),n.selectNode(i),l.addRange(n);let a=!1;try{a=window.document.execCommand("copy")}finally{l.removeAllRanges(),window.document.body.removeChild(i)}if(!a)throw t()}(e)}catch(l){throw l||i||t()}}}}}]);